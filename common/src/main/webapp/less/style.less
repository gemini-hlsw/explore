@import 'suithemes/default/globals/site.variables';
@import 'suithemes/default/modules/dropdown.variables';
@import 'theme/site/collections/form.variables';
@import 'theme/site/globals/site.variables';

// vertical buttons
@import 'verticalbuttons.less';
@import 'vendor/react-resizable.less';
@import 'vendor/react-grid-layout.less';
// theming variables
@import 'variables-dark.less';
@import 'variables-light.less';
@import 'explore-grid.less';

@gridSpace: 5px;
@minHeight: 2.85714286em; // TODO: Calculate this on less
@resizeHandleWidth: 5px; // Width of the tree resize handle

// media queries cutoff
@tablet-responsive-cutoff: 992px;
@mobile-responsive-cutoff: 670px;

// Full viewport settings taken from https://dev.to/lennythedev/css-gotcha-how-to-fill-page-with-a-div-270j

html,
body {
  margin: 0;
  padding: 0;
  box-sizing: border-box;
}

body {
  overflow: hidden;
  position: fixed;
  min-height: 100vh;

  /* mobile viewport bug fix */
  min-height: -webkit-fill-available;
  width: 100vw;
  scrollbar-width: thin;
  scrollbar-color: var(--scrollbar-background);
}

*::-webkit-scrollbar {
  width: 0.8em !important;
}

*::-webkit-scrollbar-track {
  background: var(--scrollbar-background) !important;
}

*::-webkit-scrollbar-thumb {
  background: var(--scrollbar-background-thumb) !important;
  border: 1px solid var(--scrollbar-background);

  &:active,
  &:hover {
    background: var(--scrollbar-background-thumb-hover) !important;
  }
}

a {
  color: var(--site-link-color);
}

.explore-new-emissionline-wavelength {
  .ui.input {
    padding: 0 0.5em;
  }
}

// Mixins
//
.full-height-width {
  height: 100%;
  width: 100%;
}

:root {
  color-scheme: dark;
}

// Scrollbars
// * {
//   scrollbar-width: thin;
// }

/* Works on Chrome/Edge/Safari */
// *::-webkit-scrollbar {
//   width: 12px;
// }

/*** iPhone and iOS Form Input Zoom Fixes ***/
@media screen and (device-aspect-ratio: 2/3) {

  select,
  textarea,
  input[type='text'],
  input[type='password'],
  input[type='datetime'],
  input[type='datetime-local'],
  input[type='date'],
  input[type='month'],
  input[type='time'],
  input[type='week'],
  input[type='number'],
  input[type='email'],
  input[type='url'] {
    font-size: 16px;
  }
}

@media screen and (device-aspect-ratio: 40/71) {

  select,
  textarea,
  input[type='text'],
  input[type='password'],
  input[type='datetime'],
  input[type='datetime-local'],
  input[type='date'],
  input[type='month'],
  input[type='time'],
  input[type='week'],
  input[type='number'],
  input[type='email'],
  input[type='url'] {
    font-size: 16px;
  }
}

@media screen and (device-aspect-ratio: 375/667) {

  select,
  textarea,
  input[type='text'],
  input[type='password'],
  input[type='datetime'],
  input[type='datetime-local'],
  input[type='date'],
  input[type='month'],
  input[type='time'],
  input[type='week'],
  input[type='number'],
  input[type='email'],
  input[type='tel'],
  input[type='url'] {
    font-size: 16px;
  }
}

@media screen and (device-aspect-ratio: 9/16) {

  select,
  textarea,
  input[type='text'],
  input[type='password'],
  input[type='datetime'],
  input[type='datetime-local'],
  input[type='date'],
  input[type='month'],
  input[type='time'],
  input[type='week'],
  input[type='number'],
  input[type='email'],
  input[type='tel'],
  input[type='url'] {
    font-size: 16px;
  }
}

body.dark-theme {
  .dark-theme();
}

body.light-theme {
  .light-theme();
}

@media (prefers-color-scheme: dark) {

  /* defaults to dark theme */
  body {
    .dark-theme();
  }

  /* Override dark mode with light mode styles if the user decides to swap */
  body.light-theme {
    .light-theme();
  }
}

// Classes
.tilemenu {
  background: darkgray;
}

.explore-accented {
  color: var(--explore-accent-color);
}

.explore-text-plain {
  text-transform: none;
}

.explore-text-nowrap {
  white-space: nowrap;
}

tfoot {
  background-color: var(--table-footer-background);
}

/* Avoid Chrome to see Safari hack */
@supports (-webkit-touch-callout: none) {
  .main-grid {
    /* The hack for Safari */
    height: -webkit-fill-available;
  }
}

.main-body {
  grid-area: body;
  max-width: 100vw;
  overflow: hidden;
  display: grid;
  justify-items: stretch;
}

.main-title {
  text-transform: uppercase;
  letter-spacing: 0.4em;
}

.size-detector {
  .full-height-width();
}

.main-user-name {
  margin-left: auto;
  letter-spacing: 0.1em;
  overflow: hidden;
  white-space: nowrap;
  text-overflow: ellipsis;
}

.ui.button.active.side-button {
  border-top: var(--explore-accent-color) solid 4px;
  background-color: var(--under-tab-background-active-color);
  font-weight: bold;
}

.ui.menu .item.main-user-name {
  flex-shrink: 1;
  display: inline-block;
}

.ui.tabular.menu .item.connection-icon {
  padding-right: 0.5em;
  padding-left: 0;
}

.ui.tabular.menu .item.main-menu-dropdown {
  padding-right: 0.5em;
  padding-left: 0;
  z-index: 1000;
}

// Used as part of creating headers in a FormSelect.
// Selector is very specific to avoid affecting other controls
.ui.dropdown.selection .menu .item.header.disabled {
  text-align: right;
  color: var(--dropdown-item-color);

  &:hover {
    color: var(--dropdown-item-color);
    background: unset;
  }
}

.ui.menu:not(.vertical) .right.menu.main-menu {
  margin-left: 0 !important; //SUI has !imporant
}

.explore-tile-title {
  flex-grow: 0;
  background-color: var(--tile-title-background);
  display: flex;
  flex-direction: row;
  align-items: center;

  & .tabular.menu .item {
    color: var(--tile-title-color);
    letter-spacing: 0.1em;
  }
}

.explore-tile-title-strip {
  flex-grow: 2;
  display: flex;
  align-items: center;
  justify-content: space-between;
}

.explore-fixed-size-tile-title {
  margin-right: 1em;
}

.ui.menu.explore-tile-title-menu {
  margin-top: 0;
  cursor: pointer;
  min-height: 36px;
  flex-shrink: 2;
  overflow: hidden;
  text-overflow: ellipsis;
  white-space: nowrap;
}

.ui.menu.explore-tile-title-menu .item {
  padding-left: 0.5em;
  letter-spacing: 2px;
}

.constraints-grid.ui.form .field {
  margin-bottom: 0;
}

.ui.selection.dropdown.constraints-tile-selector {
  font-size: smaller;
  margin-right: 0.5em;
}

.ui.menu.explore-tile-title-menu a.item:hover {
  background: unset;
  color: unset;
}

.ui.button.tile-back-button {
  margin-right: 0;

  @media (min-width: @mobile-responsive-cutoff) {
    display: none;
  }
}

.explore-tile-control {
  margin-right: auto;
  flex-grow: 3;
}

.main-header>.ui.tabular.menu .item {
  color: var(--main-header-color);
}

.main-header {
  grid-area: header;
  width: 100vw;
  min-width: 100vw;
  background-color: var(--main-header-background-color);

  &>.ui.tabular.menu {
    border-bottom: none;
  }
}

.sidetabs {
  grid-area: sidebar;
  background: var(--sidetab-background);
  overflow: hidden;
}

.sidetabs-divider {
  display: none;

  @media (min-width: @tablet-responsive-cutoff) {
    display: block;
  }
}

// Side tabs
.sidetabs-body {
  display: flex;

  @media (min-width: @tablet-responsive-cutoff) {
    height: 100%;
    display: block;
    overflow: hidden;
  }
}

.sidetabs-body-vertical {
  height: 100%;
  display: none;

  @media (min-width: @tablet-responsive-cutoff) {
    display: inherit;
  }
}

.sidetabs-body-horizontal {
  height: 100%;
  display: flex;
  overflow: hidden;
  padding-top: 0.2em;
  padding-bottom: 0.2em;
  width: 100vw;
  max-width: 100vw;
  justify-content: space-between;
  align-items: stretch;
  border-top: 1px solid var(--under-tab-border-color);
}

.ui.label.bottom-tab-selector {
  flex-grow: 1;
  flex-shrink: 1;
  font-weight: 300;
  text-align: center;
  padding-top: 0.4em;
  padding-bottom: 0.2em;
  margin-right: 0.2em;
  margin-left: 0.2em;
  border-radius: 0.2em;
  border: 1px solid var(--under-tab-border-color);
  background-color: var(--under-tab-background-color);
}

.ui.label.bottom-tab-selector:hover,
.ui.label.bottom-tab-selector:focus {
  border: 1px solid var(--under-tab-border-color);
  background-color: var(--under-tab-background-focus-color);
}

.ui.label.active.bottom-tab-selector {
  border: 1px solid var(--under-tab-border-color);
  border-top: var(--explore-accent-color) solid 4px;
  background-color: var(--under-tab-background-active-color);
  font-weight: bold;
}

.ui.label.active.bottom-tab-selector:hover,
.ui.label.active.bottom-tab-selector:focus {
  border: 1px solid var(--under-tab-border-color);
  border-top: var(--explore-accent-color) solid 4px;
  background-color: var(--under-tab-background-focus-active-color);
}

//----------
// Main title
//----------
// Taken from the definit√≠on of ui.button transition but removed background-color and background
// When animating those two properties you see some flickering in FF
.ui.button.side-button {
  border: 1px solid var(--under-tab-border-color);
  border-bottom: transparent solid 4px;
  border-bottom-left-radius: unset;
  border-bottom-right-radius: unset;
  background-color: var(--under-tab-background-color);
  font-weight: 300;
  transition: opacity @defaultDuration @defaultEasing,
    color @defaultDuration @defaultEasing,
    box-shadow @defaultDuration @defaultEasing;
}

.explore-tile-body {
  flex-grow: 1;
  overflow-y: auto;
  background-color: var(--tile-background);
}

.explore-tile {
  .full-height-width();

  display: flex;
  flex-direction: column;
  background-color: var(--tile-background);
}

.fade-in {
  animation: fadeIn 0.5s;
}

@keyframes fadeIn {
  0% {
    opacity: 0;
  }

  100% {
    opacity: 1;
  }
}

.ui.basic.button.explore-tile-state-button:hover {
  background: transparent;
  box-shadow: none;
  outline: none;
  filter: brightness(100%);
}

.explore-tile-state-button {
  filter: brightness(80%);
  margin-right: 0.5em;
  transform-origin: center center;
  transition: transform 0.25s, filter 0.25s ease-in;
}

.proposal-tile {
  margin: 0.5em;
}

.proposal-tile .explore-tile-body {
  padding: 1em;
}

.react-aladin {
  margin: 2px;
}

.explore-empty-tree-content {
  border: 1px solid var(--under-tab-border-color);

  div {
    font-size: 2em;
    padding-bottom: 0.3em;
    border-bottom: var(--explore-accent-color) solid 2px;
  }
}

.horizontal-vertical-center {
  display: flex;
  justify-content: center;
  align-items: center;
  height: 100%;
}

// Vertical handle to resize the tree
.resize-handle {
  width: @resizeHandleWidth;
  height: 100vh;
  display: flex;
  justify-content: center;
  align-items: center;
  user-select: none;
  cursor: ew-resize;
  position: relative;
  margin-left: -@resizeHandleWidth;
  background: black;
  z-index: 1;
}

.maingrid {
  height: 100%;
}

.target-tile-body {
  display: flex;
  flex-direction: column;

  >div {
    flex-grow: 1;
    display: flex;
    flex-direction: column;
  }
}

.target-tile-editor {
  flex-grow: 2;
  display: flex;
  flex-direction: column;
}

.expanded-aladin() {
  grid-template-areas: 'aladin';
  grid-template-columns: 1fr;

  .explore-title-undo-buttons {
    display: none;
  }

  .target-form {
    display: none;
  }

  .target-proper-motion-form {
    display: none;
  }

  .target-source-profile-editor {
    display: none;
  }
}

.aladin-full-screen {

  .explore-shared-edit-warning,
  .target-asterism-table {
    display: none;
  }

  >div .target-grid {
    .expanded-aladin();
  }

}

.explore-form.target-source-profile-editor {
  align-self: stretch;
  grid-template-rows: repeat(3, auto) 1fr;

  &.gaussian {
    grid-template-rows: repeat(4, auto) 1fr;
  }
}

.obs-tree {
  display: flex;
  flex-direction: column;
  min-height: 0;
  justify-content: center;
  flex-grow: 1;
  overflow: hidden;
}

.obs-unassigned {
  display: flex;
  flex-direction: column;
  overflow: auto;

  &.dragging-over {
    .obs-tree-header {
      background-color: rgba(0, 0, 0, 0); // transparent
    }
  }
}

.obs-item {
  margin: 0;
  padding: 0;
}

.obs-count {
  white-space: nowrap;
  font-weight: 100;
}

.obs-tree-item {
  margin-left: 25px;
  padding: 5px;
}

.card.obs-badge {
  width: 100%;
  margin: 0 0;
  background-color: var(--obs-badge-background);
  border: solid 1px var(--site-border-color);
  font-size: smaller;
}

.card.obs-badge:last-child {
  margin-bottom: 0.2em;
}

.card.obs-badge .content .header,
.card.obs-badge .content .meta,
.card.obs-badge .content .description,
.card.obs-badge .content .extra {
  color: var(--obs-badge-color);
}

.obs-badge-target-and-id {
  display: flex;
  width: 100%;
}

.obs-badge-subtitle {
  font-size: x-small;
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  width: 100%;
  margin-bottom: -1px;
}

.obs-badge-subtitle-input {
  flex-grow: 2;

  & input {
    font-size: x-small !important;
    padding: 1px !important;
  }
}

.obs-badge-subtitle-add {
  float: right;
  font-size: x-small !important;
}

.ui.button.compact.obs-badge-subtitle-edit {
  margin-left: 0.5em;
  padding-left: 0 !important;
  padding-right: 0 !important;
}

.ui.button.compact.obs-badge-subtitle-delete {
  padding-left: 0 !important;
  padding-right: 0 !important;
}

.obs-badge-id {
  margin-left: auto;
  margin-right: 1em;
  font-weight: normal;
  font-size: small;
  opacity: 0.5;
}

.selected-obs-item .card.obs-badge,
.obs-tree-item .card.obs-badge.raised {
  background-color: var(--obs-selected-badge-background);
}

.obs-tree-group-header {
  display: flex;
  flex-wrap: nowrap;
  width: 100%;
  padding: 0.5em 0.5em !important;
  align-content: center;

  .fa-thumbtack {
    margin-right: 1em;
    margin-left: 0.5em;
  }
}

.vertical.segment.selected-obs-tree-group {
  background-color: var(--tile-background);
}

.dragging-over .vertical.segment.selected-obs-tree-group {
  background-color: rgba(0, 0, 0, 0);
}

.vertical.segment.unselected-obs-tree-group:hover {
  background-color: var(--explore-group-hover);

  & .obs-tree-group-header {
    text-decoration: underline;
  }
}

.vertical.segment.obs-tree-group {
  padding-top: 0;
  padding-bottom: 0;
  padding-right: 5px;
  user-select: none;
}

.reflex-element.obs-tree-section {
  display: flex;
  flex-direction: column;
}

.eraser-icon,
.trash-icon {
  color: var(--negative-icon-color);
}

.obs-group-title-mixin() {
  flex-grow: 2;
  margin-right: 5px;
}

.obs-group-title {
  .obs-group-title-mixin();

  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
}

.obs-group-title-with-wrap {
  .obs-group-title-mixin();

  white-space: normal;
  overflow: visible;
}

.justify-right {
  align-self: center;
  justify-self: end;
}

.dragging-over {
  background-color: var(--explore-group-dragging) !important;
}

.elevation-plot-tile-body {
  position: relative;
  display: flex;
  flex-direction: column;
}

.elevation-plot {
  flex-shrink: 1;
  flex-grow: 1;
  height: 100%;

  .highcharts-xaxis .highcharts-axis-title {
    fill: hsl(0, 87%, 66%);
  }

  >div {
    height: 100%;
    max-height: 100%;

    div[data-highcharts-chart] {
      height: 100%;
      max-height: 100%;
    }
  }
}

.plot-section {
  min-width: 1px; // Needed to help highcharts recompute width on the fly.
  width: 100%;
  height: 100%;
  max-height: 100%;
  position: relative;
  background-color: var(--plot-background-color);
  color: var(--plot-text-color);
}

.elevation-plot-section {
  .plot-section();
  display: flex;
  flex-direction: column;

  .ui.checkbox+label {
    color: var(--plot-text-color);
  }
}

.elevation-plot-controls {
  display: flex;
  justify-content: space-around;
  align-items: baseline;
  background-color: var(--plot-background-color);
  color: var(--plot-text-color);
  margin: 0.2em;

  .ui.compact.buttons .button,
  .ui.compact.button {
    padding: 0.31em 0.5em 0.31em;
    font-size: small;
    font-weight: normal;
  }
}

.elevation-plot-datepicker-controls {
  white-space: nowrap;
  display: flex;
  align-items: center;
}

.elevation-plot-datepicker {
  width: 100px !important;
  text-align: center;
  font-size: small !important;
  font-weight: normal !important;
}

.elevation-plot-date-button {
  padding: 0 !important;
  border: 0 !important;
  margin-left: 0.25em !important;
  background-color: var(--plot-background-color) !important;
}

.plot-toggle-checkbox {
  white-space: nowrap;
  display: flex;
}

.plot-toggle {
  margin-left: 0.5rem;
  margin-right: 0.5rem;
  padding-top: 4px;
}

.plot-toggle.ui.fitted.slider.checkbox {
  width: 2.5rem;
}

.plot-toggle.ui.slider.checkbox label::before {
  width: 2.5rem;
}

.plot-toggle.ui.slider.checkbox .box::before,
.plot-toggle.ui.slider.checkbox label::before {
  background-color: hsl(0, 0%, 33%) !important;
}

.plot-toggle.ui.slider.checkbox label::after {
  width: 1rem;
  height: 1rem;
  top: -0.05rem;
}

.plot-toggle.ui.slider.checkbox input:focus:checked~label::before {
  background-color: hsl(0, 0%, 33%) !important;
}

.plot-toggle.ui.slider.checkbox input:checked~label::after {
  left: 1.5rem;
}

.ui.grid>.row>.column.aladin-column {
  padding-top: 0;
  padding-bottom: 0;
}

.aladin-container-column {
  height: 100%;
  display: grid;
  grid-template-rows: 1fr min-content;
  grid-template-columns: max-content min-content 1fr 1fr min-content;
  align-content: stretch;
  position: relative;
  grid-template-areas:
    'aladin aladin    aladin    aladin aladin'
    'fov    agsstatus guidestar curr   center';
}

.aladin-search-icon {
  align-self: center;
  margin-left: 0.5em;
}

.moon-phase {
  position: absolute;
  top: 5px;
  right: 1rem;
}

.connection-ok {
  color: greenyellow;
}

.connection-warning {
  color: gold;
}

.connection-error {
  color: red;
}

.wip {
  position: relative;
  display: inline-block;
}

.wip .wip-warning {
  visibility: hidden;
  width: 120px;
  background-color: yellow;
  color: black;
  text-align: center;
  border-radius: 6px;
  padding: 5px 0;

  /* Position the tooltip */
  position: absolute;
  z-index: 3;
  top: 30px;
  left: calc(50% - 60px);
}

.wip:hover .wip-warning {
  visibility: visible;
}

.edit-warning {
  padding: 5px !important; // important to override SUI's style.
  position: absolute !important; // important to override SUI's style.
  z-index: 2000;
  width: 100%;
}

.target-form {
  grid-template-columns: [label] minmax(100px, 10%) [field] 1fr;
  justify-items: stretch;
}

.target-search-form {
  grid-column: 1 / span 2;
  display: grid;
  grid-template-columns: [label] minmax(100px, 10%) [field] minmax(calc(100% - 100px - 0.3em),
      calc(90% - 0.3em));
  grid-gap: 0.3em;

  .field {
    margin-bottom: 0 !important;
  }

  .ui.input {
    display: grid;
    grid-template-columns: [input] calc(100% - 20px) [svg] 20px;
  }
}

.target-brightness-cell {
  .form {
    height: 100%;
  }
}

.target-asterism-editor {
  align-self: stretch;
  outline: 3px solid pink !important;
}

.target-rv-controls {
  justify-self: stretch;

  .explore-grow-1 {
    margin-left: 0.3em !important;
  }
}

.catalogue-form {
  height: max-content; // keep it from expanding to fill cell
}

// for the ra and dec inputs expand
.target-ra-dec-min-width {
  .ui.input {
    width: 100%;
  }
}

.error-label-mixin() {
  color: var(--negative-text-color);
  background-color: var(--negative-background-color);
}

.ui.label.explore-error-label {
  .error-label-mixin();
}

.ui.form .field>.explore-error-label {
  .error-label-mixin();
}

.ui.form .field>label {
  margin: 0;
}

.ui.basic.label.explore-section-label {
  background-color: transparent;
  border: none;
  letter-spacing: 0.15em;
  border-radius: 0;
  border-bottom: 1px solid var(--input-color);
}

.explore-table-units-label {
  margin-left: 0.25em;
  font-size: x-small;
}

.explore-units-label {
  margin-left: 0.25em;
}

.proposal-details-grid {
  /*
  Requirement was for the entire second column to go below
  the first column for narrow screens. In order to keep tab
  order consistent, the elements are defined in the single
  column order in the DOM, and CSS is used to place them in
  the correct place in the 2 column grid.
  */
  @proposal-details-grid-items: 7;

  each(range(1, @proposal-details-grid-items), {
    @num-in-first-col: ceil((@proposal-details-grid-items / 2));
    @second-col: boolean(@value > @num-in-first-col);
    @col-start: if(@second-col, 2, 1);
    @row-start: if(@second-col, @value - @num-in-first-col, @value);

    & > *:nth-child(@{value}) {
      @media not all and (max-width: @two-column-break) {
        grid-row-start: @row-start;
        grid-column-start: @col-start;
      }
    }
  });
}

.minimum-percent {
  width: 5.5em;
  padding-left: 0.5em !important;

  div& .ui.input input {
    text-align: right;
  }

  span& {
    text-align: end;
  }
}

// The split edit button and the band totals
.partner-split-data {

  &,
  div& data {
    width: 6em;
  }

  // the text only "hours".
  span& {
    text-align: end;
    padding-right: 6px; // determined empirically from dev tools
  }

  // The div containing the flag and percent text.
  data>div {
    display: flex;

    // The percent text
    span {
      flex: 1;
      text-align: end;
    }
  }
}

div.partner-split-total {

  &,
  &>div>data {
    width: 5.5em;
  }

  &>div>data {
    text-align: end;
  }
}

.explore-brightnesses-wrapper {
  grid-column: 1 / -1;
  justify-self: stretch;
  align-self: stretch;
}

.explore-brightnesses-container {
  height: 100%;
  display: flex;
  flex-direction: column;
}

.target-grid {
  display: grid;
  grid-gap: 0.5em;
  grid-row-gap: 0.3em;
  padding: 0.5em;
  height: 100%;

  .explore-title-undo-buttons {
    grid-area: undo;
  }

  .target-aladin-cell {
    grid-area: aladin;
  }

  .target-form {
    grid-area: coordinates;
  }

  .target-proper-motion-form {
    grid-area: proper-motion;
  }

  .target-source-profile-editor {
    grid-area: source-profile;
  }
}

.tile-xl-width,
.tile-lg-width,
.tile-md-width,
.tile-sm-width {
  .target-grid {
    grid-template-columns: 1fr 2fr;
    grid-template-rows: min-content min-content min-content 1fr;
    grid-template-areas:
      'undo           aladin'
      'coordinates    aladin'
      'proper-motion  aladin'
      'source-profile aladin';
  }

  .target-aladin-cell {
    grid-row: span 4;
  }
}

// For very small tables hide the headers and add fake "header" to the left of the row
.tile-xs-width {

  // For very small tables make the undo buttons remove the text
  .explore-buttons-undo-label {
    display: none;
  }

  .target-grid {
    .expanded-aladin();
  }

  .explore-brightnesses-container {

    .ui.table,
    thead,
    tbody,
    th,
    td,
    tr {
      // SUI already has an !important
      display: block !important;
    }

    // Hide table headers (but not display: none;, for accessibility)
    thead tr {
      position: absolute;
      top: -9999px;
      left: -9999px;
    }
  }
}

// position all fields relative so that error labels position properly.
.ui .field {
  position: relative;
}

.explore-input-error-mixin() {
  left: 30%;
  z-index: 3;
}

.explore-input-error-tooltip {
  transform: translate(0, -33px);
  .explore-input-error-mixin();
}

.explore-input-error-tooltip-below {
  transform: translate(0, 20px);
  .explore-input-error-mixin();
}

.ui.button.blended-button {
  border: none;
  background-color: transparent;
  box-shadow: none;

  &:hover {
    outline: 1px var(--site-border-color) solid;
  }
}

.ui.button.delete-button {
  padding: 0;
  margin: 0;
  margin-right: 0.4em;
  border: none;
  background-color: transparent;
  box-shadow: none;
  display: flex;
  justify-content: center;

  &:hover {
    outline: 1px var(--site-border-color) solid;
  }
}

.ui.form .field.flat-form-field {
  margin-bottom: 0;
}

.warning-label-mixin() {
  color: var(--warning-text-color);
  background-color: var(--warning-background-color);
}

span.fa-layers-text {
  font-weight: 900;
  transform: scale(0.6) translate(-1em, -2.4em) rotate(30deg);
}

div.field.explore-warning-input,
div.inline.field.explore-warning-input {
  box-shadow: -0 0 2px 1px var(--warning-background-color);
}

.ui.label.explore-warning-label {
  .warning-label-mixin();
}
#staging-banner {
  @spacing: 20;

  z-index: 2000;
  position: absolute;
  top: 0;
  left: 50%;
  transform: translate(-50%, 0);
  text-transform: uppercase;
  text-indent: @spacing;
  letter-spacing: @spacing;
  padding: 0.5em 1em;
  font-weight: 900;
  background-color: var(--explore-accent-color);
}

// https://zellwk.com/blog/creating-focus-style/
i.icon.explore-button-icon:hover,
i.icon.explore-button-icon:focus {
  outline: none;
  opacity: 1;
  box-shadow: 0 0 0 0.1rem var(--focus-inner-color),
    0 0 0 0.2rem var(--focus-outer-color);
}

html {
  // Required for iOS to work with 100vh
  // https://css-tricks.com/css-fix-for-100vh-in-mobile-webkit/
  height: -webkit-fill-available;
}

.observer-notes-wrapper {
  display: flex;
  justify-content: center;
  align-content: center;
}

.observer-notes {
  padding: 1em;
}

// This selector is never matched after the new table transistion. But, the table doesn't
// seem to be shown on small screens?
// https://css-tricks.com/responsive-data-tables/
// .tile-xs-width .explore-brightnesses-container .ui.ui.ui.ui.table:not(.unstackable) {
//   tfoot {
//     display: block;
//   }

//   td {
//     /* Behave  like a "row" */
//     position: relative;
//     padding-left: 40%;
//     padding-right: 0.5em;
//   }

//   td::before {
//     /* Now like a table header */
//     position: absolute;

//     /* Top/left values mimic padding */
//     top: 6px;
//     left: 6px;
//     width: 45%;
//     padding-left: 0.25em;
//     white-space: nowrap;
//   }

//   td:first-child::before {
//     font-weight: normal;
//   }

//   // It is a bit unfortunate that we have to hardcode the column names here
//   td:nth-of-type(1)::before {
//     content: 'Value';
//   }

//   td:nth-of-type(2)::before {
//     content: 'Band';
//   }

//   td:nth-of-type(3)::before {
//     content: 'System';
//   }

//   td:nth-of-type(4)::before {
//     content: '';
//   }

//   // Align the trash button
//   td:last-child button {
//     margin-left: auto;
//   }
// }

.explore-brightnesses-units-dropdown.p-dropdown {
  white-space: nowrap;
  width: 100%;
}

.explore-brightnesses-delete-button-wrapper {
  display: flex;
  justify-content: center;

  .p-button.delete-button {
    padding: 0;
  }
}

// TODO: Temporary until the entire sidereal target editor is converted to primereact
.explore-brightnesses-wrapper .explore-brightnesses-container {
  // Because even the brightnesses tabler is embedded in a SUI Form, the SUI CSS os overriding 
  // the primereact CSS.
  .p-inputgroup.pl-form-field input {
    font-family: "Lato", "Helvetica Neue", Arial, Helvetica, sans-serif;
    font-size: 1rem;
    color: rgba(255, 255, 255, 0.87);
    background: #121212;
    padding: 0.25rem 0.5rem;
    border: 1px solid #383838;
    transition: background-color 0.2s, color 0.2s, border-color 0.2s, box-shadow 0.2s;
    appearance: none;
    border-radius: 4px;
  }

  // Need to do some theme work on the dropdowns.
 .p-dropdown .p-dropdown-trigger-icon {
  font-size: .929em;
 } 
}

.explore-brightnesses-footer {
  display: flex;
  justify-content: flex-start;
  padding: 0.2em;
  border-top: 0.2px solid var(--under-tab-border-color);
  background-color: var(--table-footer-background);
}

.p-button.explore-brightnesses-add-button {
  margin-left: 5px;
}

.obs-badge-header {
  display: flex;
  align-items: center;
}

.obs-badge-description {
  display: flex;
  justify-content: space-between;
  text-overflow: ellipsis;
}

.crash-message {
  position: fixed;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%);
  text-align: center;
}

.ui.wide.right.sidebar {
  max-width: 100%;
  overflow: hidden !important;
}

.step-guided {
  color: lightgreen;
}

.explore-configuration-grid {
  display: flex;
  flex-direction: column;
  padding: 0.5em;
  gap: 0.5em;
  height: 100%;
}

.explore-basic-configuration-grid {
  min-height: 0;
  height: 100%;
  display: grid;
  gap: 0.5em;
  grid-template-areas:
    'form table-header'
    'form table'
    'form buttons';
  grid-template-columns: auto minmax(0, 1fr);
  grid-template-rows: auto 1fr auto;
}

.explore-form {
  display: grid;
  justify-items: start;
  align-items: baseline;
  align-self: start;
  grid-template-columns: [label] minmax(120px, 10%) [field] 1fr [units] auto;

  .field {
    justify-self: stretch;
  }

  .explore-units-label {
    justify-self: start;
  }

  .field .ui.input,
  .field .ui.selection.dropdown {
    min-width: 100%;
  }
}

.explore-skip-to-next {
  grid-column: 1;
}

.seq-gen-parameters-form {
  display: flex;
  justify-content: space-around;
}

.explore-configuration-input-with-units {
  display: flex;
  margin-left: 0.25em;
  align-items: baseline;

  .explore-units-label {
    align-self: baseline;
    margin-bottom: unset;
  }

  :first-child {
    margin-right: 0.25em;
  }

  .field {
    width: 10ch;
  }
}

.explore-configuration-capabilities {
  grid-column: span 2;
}

.block.header.obs-tree-header {
  padding-top: 5px;
  padding-bottom: 5px;
  padding-right: 5px;
  user-select: none;
  margin-top: 2px;
  margin-bottom: 0;
  display: flex;
  justify-content: space-between;
}

.ui.dropdown.explore-configuration-filter {
  min-width: 100%;

  .menu>.item>.header {
    text-align: center;
    text-transform: uppercase;
    text-decoration: underline;
    font-size: smaller;
    pointer-events: none;
    cursor: unset;
  }
}

.explore-configuration-filter-item {
  display: grid;
  grid-template-columns: repeat(3, 1fr);
  justify-items: end;

  span:first-child {
    justify-self: start;
  }

  span:not(:first-child) {
    color: var(--site-input-placeholder-focus-color);
    font-size: smaller;
  }
}

.explore-button-copy {
  border: 0 !important; // important to override SUI's style.
}

.explore-buttons-undo {
  margin-left: auto;
}

.explore-button-summary {
  width: 100%;
}

.ui.labeled.icon.button.verycompact {
  padding-left: 2.3em !important;
  padding-right: 0.5em !important;

  .icon {
    width: 2em;
  }
}

.explore-shared-edit-warning {
  .warning-label-mixin();

  padding: 0.4em;

  .checkbox {
    padding-left: 2em;
  }
}

.tile-xs-width {
  .explore-shared-edit-warning {
    display: none;
  }
}

.explore-title-undo-buttons {
  text-align: right;
}

.explore-title-select-columns {
  text-align: right;
  display: none;
}

@media (min-width: @mobile-responsive-cutoff) {
  .explore-title-select-columns {
    display: inline;
  }
}

.explore-select-columns {
  .menu {
    max-height: 30em !important;
    z-index: 3000 !important;

    .item {
      font-size: small !important;
    }
  }
}

.explore-target-summary-delete {
  left: 0;
}

.explore-target-summary-select {
  left: 0;
  width: 70px;

  .p-button {
    width: 55px;
    display: flex;
    justify-content: space-evenly;
  }
}

.explore-target-summary-id {
  left: 0;
  width: 55px;
  min-width: 55px;
}

.explore-target-summary-type,
.explore-constraints-summary-edit {
  left: 0;

  &.with-delete {
    left: 35px;
  }

  &.with-expander {
    left: 29px;
  }

  &.with-select {
    left: 75px;
  }

  &.with-id {
    left: 55px;
  }
}

.explore-target-summary-name {
  &.with-delete {
    left: 70px;
  }

  &.with-expander {
    left: 76px;
  }

  &.with-select {
    left: 109px;
  }

  &.with-id {
    left: 89px;
  }
}

.explore-target-summary-subrow-cell {
  padding-left: 10px;
}

.ui.label.explore-modes-table-target {
  display: block;
  overflow: hidden;
  text-overflow: ellipsis;
  white-space: nowrap;
}

.explore-modes-table-count {
  flex-shrink: 0;
}

.explore-modes-table-info {
  flex-grow: 0;
  overflow: hidden;
  justify-self: flex-end;
}

.explore-modes-table-title {
  grid-area: table-header;
  display: flex;
  gap: 0.5em;
  justify-content: space-between;
}

.explore-modes-table {
  grid-area: table;
}

.explore-obs-configuration-form {
  grid-area: obs-props;
  display: flex;
  gap: 0.3em;
  align-items: baseline;
  border-bottom: 1px solid var(--site-border-color);

  .field .ui.selection.dropdown[id='pos-angle-alternative'] {
    min-width: 18ch;
    padding-left: 0.3em;
    padding-right: 0.3em;
  }
}

.ui.form.explore-obs-configuration-form .field {
  margin-bottom: 0.5em;
}

.explore-basic-configuration-buttons {
  grid-area: buttons;
  justify-self: end;
}

.explore-basic-configuration-form {
  grid-area: form;
  grid-row-end: span 3;
}

.explore-modes-header {
  top: 0;
  white-space: nowrap;
}

.ui.button.compact,
.ui.labeled.icon.button.left.verycompact {
  padding-left: 0.5em !important;
  padding-right: 0.5em !important;
}

.ui.icon.button svg.svg-inline--fa,
.ui.button.compact svg.svg-inline--fa,
.ui.button.verycompact svg.svg-inline--fa {
  width: 1.5em;
}

svg.padded-right-icon.svg-inline--fa,
.ui.icon.labeled.button svg.svg-inline--fa,
.ui.menu .ui.dropdown .menu>.item svg.svg-inline--fa {
  margin-right: 3px;
}

// Remove the focus on icons
svg[focusable='false']:focus {
  outline: none;
}

.modal-close-button {
  z-index: 1;
  position: absolute;
  top: -1rem;
  right: -1rem;
  opacity: 0.8;
  cursor: pointer;

  &:hover {
    opacity: 1;
  }
}

.user-selection-buttons {
  display: flex;
  flex-direction: column;
}

.obs-badge-extra {
  margin-top: 5px;
  display: flex;
  justify-content: space-between;
}

.obs-status-select {
  flex-grow: 2;
  margin-right: 2em;

  .ui.dropdown {
    width: 100%;
    font-size: inherit;

    .menu .item {
      font-size: inherit;
      border: 0;
    }
  }
}

.ui.toggle.checkbox.obs-active-status-toggle {
  transform: rotate(270deg) scale(0.6) translate(-100%, 70%);
  width: auto;

  input:checked~label::before {
    background-color: var(--checkbox-toggle-checked-background) !important;
  }
}

.ui.selectable.table>tbody>tr:hover,
.ui.selectable.table .tbody .tr:not(.disabled):not(.thead > .tr):not(.tfoot > .tr):hover,
.ui.table tbody tr td.selectable:hover,
.ui.table .tbody .tr:not(.disabled) .td.selectable:not(.thead > .tr):not(.tfoot > .tr):hover {
  box-shadow: inset 0 1px 0 0 var(--explore-accent-color),
    inset 0 -1px 0 0 var(--explore-accent-color);
}

.ui.popup.explore-compact {
  padding: 0.5em;
}

.explore-modes-table-itc-cell {
  display: flex;
  justify-content: center;
}

.explore-sequence-obs-subtitle {
  font-size: small;
}

tbody tr td.sticky-column {
  position: sticky;
  background: inherit;
  clip-path: inset(2px 0); // Avoids overwriting the box-shadow.
}

thead tr th.sticky-column {
  position: sticky;
  background: inherit;

  &.sticky-header {
    z-index: 15;
  }
}

thead tr th.sticky-header {
  position: sticky;
  top: 0;
  z-index: 10;
}

.explore-modes-table-itc-header-cell {
  display: inline-flex;
  align-items: center;
  justify-content: space-between;
}

.explore-modes-table-itc-circular-progressbar {
  height: 16px;
  padding-left: 4px;

  .CircularProgressbar-trail {
    stroke: none !important;
  }

  .CircularProgressbar-path {
    stroke: var(--site-text-color) !important;
  }
}

.ui.striped.table tr:nth-child(2n + 1) td.sticky-column,
.ui.striped.table tr:nth-child(2n + 1) .td.sticky-column {
  background-color: var(--table-background);
}

.ui.striped.table tr:nth-child(2n) td.sticky-column,
.ui.striped.table tr:nth-child(2n) .td.sticky-column {
  background-color: var(--table-striped-background);
}

.ui.striped.table tr:hover td.sticky-column,
.ui.striped.table tr:hover .td.sticky-column {
  background: var(--table-selectable-background);
  color: var(--table-selectable-color);
}

// Override SUI's default, which prevented shrinking on small screens.
.ui.form .field .ui.input input,
.ui.form .fields .field .ui.input input {
  width: 100%;
}

.ui.form .field .ui.icon.input input,
.ui.form .fields .field .ui.icon.input input {
  width: auto;
}

.ui.form .field.field input:-webkit-autofill,
.ui.form .field.field input:-webkit-autofill:hover,
.ui.form .field.field input:-webkit-autofill:focus,
.ui.form .field.field input:-webkit-autofill:active,
.ui.input input:-webkit-autofill,
.ui.input input:-webkit-autofill:hover,
.ui.input input:-webkit-autofill:focus,
.ui.input input:-webkit-autofill:active,
.ui.form input:-webkit-autofill,
.ui.form input:-webkit-autofill:hover,
.ui.form input:-webkit-autofill:focus,
.ui.form input:-webkit-autofill:active,
input:-webkit-autofill,
input:-webkit-autofill:hover,
input:-webkit-autofill:focus,
input:-webkit-autofill:active {
  box-shadow: 0 0 0 30px var(--form-input-background) inset !important;
  -webkit-box-shadow: 0 0 0 30px var(--form-input-background) inset !important;
  -webkit-text-fill-color: var(--input-color);
  border: 1px solid var(--site-border-color) !important;
}

// Reusability overlays.
body.hide-reusability {
  &>div:not(#root)[title^="Last update reason"] {
    display: none;
  }
}

.input-replacement-icon {
  line-height: @inputLineHeight;
  border: 1px dashed transparent; // the border makes the sizing work.
  padding: @inputPadding;
}


.ui.ui.ui.ui.icon.input .clearable-input-icon {
  // These values were obtained empirically by using the debugger to find
  // the values used by `.dropdown.icon`. They are being calculated somewhere
  // in SUI, but I haven't found the location.
  position: absolute;
  font-family: "Dropdown";
  backface-visibility: hidden;
  font-weight: normal;
  font-style: normal;
  text-align: center;
  float: right;
  opacity: 0.6;
  top: 0.35714286em;
  right: 0.42857143em;
  z-index: 3;
  margin: -0.35714286em;
  padding: 0.41666667em;
  line-height: 1.21428571em;

  &:before {
    content: "‚®â";
    top: 0.2em;
    right: 0.2em;
    position: absolute;
    font-size: medium;
  }
}

.field.clearable-input-padding-reset>.ui.ui.ui.ui.icon.input>input {
  padding: @inputPadding;
}
